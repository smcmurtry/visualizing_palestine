<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.js"></script>
</head>
<style>

@font-face { font-family: Effra_Std_Md; src: url('../data/Effra-Font/Effra_Std_Md.ttf'); }

.registry-text {
  font-family: Effra_Std_Md, sans-serif;
  color: #FFFDFF;
  position: absolute;
  text-align: center;
}

</style>

<body>
<div class='pop_registry'></div>
</body>
<script>

function draw_population_registry(left_margin_pop, top_margin_pop) {
  
  d3.select('.pop_registry').style('margin-left', left_margin_pop + 'px');
  d3.select('.pop_registry').style('margin-top', top_margin_pop + 'px');

  var card_h = 150,
      card_w = 1.6*card_h,
      house_w = 320,
      house_h = 200,
      svg_w = 420,
      svg_h = 380;

  var card_margin = {top: 0, left: 90},
      house_margin = {top: card_h, left: 50};

  var photo_margin = 0.05*card_w,
      corner_radius = 0.05*card_w,
      photo_w = 0.3*card_w,
      photo_h = 0.75*card_h,
      head_radius = 0.33*photo_w,
      shoulder_radius = 0.39*photo_w,
      head_cy = photo_margin + photo_h/3,
      left_margin_body = +d3.select('body').style('margin-left').slice(0, -2),
      top_margin_body = +d3.select('body').style('margin-top').slice(0, -2),
      text_top = 0.1*house_h + top_margin_pop + top_margin_body +  house_margin.top,
      text_left = left_margin_pop + left_margin_body +  house_margin.left;

  var svg = d3.select(".pop_registry").append("svg")
      .attr("width", svg_w)
      .attr("height", svg_h);

  var g_card = svg.append("g")
      .attr("transform", "translate(" + card_margin.left + "," + card_margin.top + ")");

  var g_house= svg.append("g")
      .attr("transform", "translate(" + house_margin.left + "," + house_margin.top + ")");

  g_card.append('rect')
    .attr('class', 'card')
    .attr("width", card_w)
    .attr("height", card_h)
    .attr('rx', corner_radius)
    .attr('ry', corner_radius)
    .attr('stroke', '#949599')
    .attr('stroke-width', 1)
    .style('fill', '#FFFDFF');

  g_card.append('circle')
    .attr('class', 'person')
    .attr('cx', photo_margin + photo_w/2)
    .attr('cy', head_cy)
    .attr('r', head_radius)
    .attr('fill', '#949599');

  g_card.append('rect')
    .attr('class', 'person')
    .attr('x', photo_margin + 0.025*photo_w)
    .attr('y', head_cy + head_radius + 3)
    .attr('width', photo_w*0.95)
    .attr('height', 0.7*photo_h)
    .attr('rx', shoulder_radius)
    .attr('ry', shoulder_radius)
    .attr('fill', '#949599');

  function draw_hline(x1, x2, y) {
    g_card.append('line')
      .attr('x1', x1)
      .attr('x2', x2)
      .attr('y1', y)
      .attr('y2', y)
      .attr('stroke', '#949599')
      .attr('stroke-width', 1);
    }

  draw_hline(0.4*card_w, 0.93*card_w, 0.2*card_h);
  draw_hline(0.4*card_w, 0.93*card_w, 0.35*card_h);
  draw_hline(0.4*card_w, 0.93*card_w, 0.5*card_h);

  g_house.append('rect')
    .attr('width', house_w)
    .attr('height', house_h)
    .attr('fill', '#3A3A3C')
    .attr('stroke', '#5B5B5D')
    .attr('stroke-width', 10);

  g_house.append('rect')
    .attr('width', 1.1*house_w)
    .attr('height', 0.1*house_h)
    .attr('y', house_h + 5)
    .attr('x', -0.05*house_w)
    .attr('fill', '#3A3A3C');

  g_house.append('polygon')
    .attr('points', '160,-60 350,0 -30,0')
    .attr('fill', '#3A3A3C')
    .attr('stroke', '#5B5B5D')
    .attr('stroke-width', 10);

  d3.select('.pop_registry')
    .append('div')
    .attr('class', 'registry-text')
    .style('width', house_w + 'px')
    .attr('height', house_h + 'px')
    .style('top', text_top + 'px')
    .style('left', text_left + 'px')
    .style('font-size', 40 + 'px')
    .html('ISRAELI POPULATION REGISTRY');

}

draw_population_registry(0, 0);

</script>